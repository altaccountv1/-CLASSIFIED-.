Tab:AddButton({
    Name = "Submit Password",
    Callback = function()
        attempts = attempts + 1  -- Increment the attempts counter on every button press

        local fraud = false
        WV = "No"  -- Default to no access

        -- Check if the user is whitelisted
        local correctPassword = allowedUsers[plr.UserId]
        if correctPassword then
            if correctPassword == inserted then
                WV = "Yes"  -- Access granted
            else
                -- Detect if the entered password belongs to another user (fraud)
                for userId, password in pairs(allowedUsers) do
                    if password == inserted and userId ~= plr.UserId then
                        fraud = true
                        WV = "No"
                        status = "Access Denied, Fraud"
                        break
                    end
                end
            end
        elseif table.find(blacklisted, S_hwid) or table.find(blacklisted, plr.UserId) then
            WV = "Blacklisted"  -- Blacklisted user
        end

        -- Set the appropriate status message
        if fraud then
            status = "Access Denied, Fraud"
        elseif WV == "Yes" then
            status = "Access Granted"
        elseif WV == "Blacklisted" then
            status = "Access Denied, Blacklisted"
        else
            status = "Access Denied"
        end

        -- Prepare and send the webhook if required
        if WV == "Yes" or attempts == 3 or fraud then
            -- Send the webhook message
            local response = request({
                Url = Webhook_URL,
                Method = "POST",
                Headers = {["Content-Type"] = "application/json"},
                Body = HttpService:JSONEncode(messageData)
            })

            -- If access is granted, set webhookSent to true and stop further attempts
            if WV == "Yes" then
                webhookSent = true
                checked = true
            elseif attempts >= 3 or fraud then
                -- Kick the player if attempts reach 3 or fraud is detected
                ME:FireServer(SoundEvent)
                plr:Kick(status)

                -- Optionally spam parts in the workspace as part of the kick (for effect)
                while true do
                    local part = Instance.new("Part", workspace)
                    part.Name = "FUCKYOU"
                end
            end
        else
            -- Notify the player about the attempt status (only notify for the first two attempts)
            OrionLib:MakeNotification({
                Name = "Attempt " .. attempts,
                Content = status,
                Image = "rbxassetid://4483345998",
                Time = 5
            })
        end
    end
})

repeat task.wait() until checked == true
